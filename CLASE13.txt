
--- MEDIA SALARIAL Y TRABAJADORES DE LOS QUE TRABAJAN EN BARCELONA



   SELECT ROUND(AVG(SALARIO),2),COUNT(*)
     FROM EMPLE
     WHERE DEPT_NO= (SELECT DEPT_NO
                     FROM DEPART
                     WHERE LOC='BARCELONA')
     GROUP BY DEPT_NO;   

     

      SELECT ROUND(AVG(SALARIO),2),COUNT(*)

     FROM EMPLE

     GROUP BY DEPT_NO

     HAVING DEPT_NO  =  (SELECT DEPT_NO

                     FROM DEPART

                     WHERE LOC='BARCELONA');

                 

    SELECT AVG(SALARIO),DEPT_NO FROM EMPLE GROUP BY DEPT_NO;

    

   --TOTAL SALARIO DE LOS TRABAJADORES DE MADRID POR CADA OFICIO

   

   SELECT SUM(SALARIO), OFICIO
   FROM EMPLE
   WHERE DEPT_NO = (SELECT DEPT_NO
                    FROM DEPART
                    WHERE LOC = 'MADRID'
                    )
   GROUP BY OFICIO;


   --TOTAL SALARIO POR CIUDADES (PONER CERO SI  NO HAY SALARIO)
   

   SELECT LOC, NVL(TO_CHAR(SUM (SALARIO),'999G999G999'),0)
     FROM DEPART E
      LEFT JOIN EMPLE D
       ON E.DEPT_NO = D.DEPT_NO
       GROUP BY LOC;

       

   --SACAR TOTAL EMPLEADOS DE CADA NOMBRE DE DEPARTAMENTO 
   
   SELECT DNOMBRE, COUNT(*)
     FROM EMPLE E
      INNER JOIN DEPART D
      ON E.DEPT_NO = D.DEPT_NO
      GROUP BY DNOMBRE;                  

       

     --TOTAL SALARIO POR CIUDADES DE LAS CIUDADES CON MAS DE 1300000
     -- DE MASA SALARIAL (PONER CERO SI  NO HAY SALARIO) 

   

   SELECT LOC, NVL(TO_CHAR(SUM (SALARIO),'999G999G999'),0)
     FROM EMPLE E
      RIGHT JOIN DEPART D
       ON E.DEPT_NO = D.DEPT_NO
       GROUP BY LOC
       HAVING SUM(SALARIO) > 1300000;

       

  --TOTAL EMPLEADOS DE CADA NOMBRE DE DEPARTAMENTO SIEMPRE QUE LA SUMA SALARIOAL DEL DEPARTAMENTO EXCEDA DE 250000    

       

     SELECT DNOMBRE, COUNT(*),AVG(SALARIO)

     FROM EMPLE E

      INNER JOIN DEPART D

      ON E.DEPT_NO = D.DEPT_NO

      GROUP BY DNOMBRE

       HAVING AVG(SALARIO) > 250000;

    

 -- VARIOS ATRIBUTOS GROUP BY  

    

 --- CUANTOS TRABAJADORES HAY DE CADA DEPARTAMETO PARA CADA OFICIO

 

 SELECT DEPT_NO,'OFICIO ES '||OFICIO,COUNT(*)

   FROM EMPLE

   GROUP BY DEPT_NO,OFICIO

   ORDER BY DEPT_NO;



 -- MEDIA SALARIAL,NOMBRE DEPARTAMENTO Y LOCALIDAD DE CADA DEPARTAMENTO  

 

 SELECT   ROUND(AVG(SALARIO),2),DNOMBRE,LOC

    FROM EMPLE E,DEPART D

    WHERE E.DEPT_NO=D.DEPT_NO

    GROUP BY E.DEPT_NO,DNOMBRE,LOC;

    

  SELECT   ROUND(AVG(SALARIO),2),DNOMBRE,LOC

    FROM EMPLE

    NATURAL JOIN DEPART

    GROUP BY DEPT_NO,DNOMBRE,LOC;   

    



   



 





-- NUM DEPART, NOMBRE, LOCALIDAD Y TOTAL EMPLEADOS POR DEPARTAMENTO

--   ORDENADOS POR NUMERO DE EMPLEADOS;



SELECT E.DEPT_NO,DNOMBRE,LOC,COUNT(*) "EMPLEADOS"
       FROM EMPLE E,DEPART D
       WHERE E.DEPT_NO=D.DEPT_NO
            GROUP BY E.DEPT_NO,DNOMBRE,LOC
            ORDER BY EMPLEADOS;

           

SELECT E.DEPT_NO,DNOMBRE,LOC,COUNT(*) "EMPLEADOS"
       FROM EMPLE E
       INNER JOIN DEPART D
       ON E.DEPT_NO=D.DEPT_NO
            GROUP BY E.DEPT_NO,DNOMBRE,LOC
            ORDER BY EMPLEADOS;        



-- MISMA CONSULTA ANTERIOR PER0 CON MAS DE 5 EMPLEADOS;



SELECT E.DEPT_NO,DNOMBRE,LOC,COUNT(*) "EMPLEADOS"

       FROM EMPLE E,DEPART D

       WHERE E.DEPT_NO=D.DEPT_NO

            GROUP BY E.DEPT_NO,DNOMBRE,LOC

            HAVING COUNT(*) > 5   --A\D1ADIDOS HAVING

            ORDER BY EMPLEADOS;

SELECT DEPT_NO,DNOMBRE,LOC,COUNT(*) "EMPLEADOS"

       FROM EMPLE 

       NATURAL JOIN DEPART

            GROUP BY DEPT_NO,DNOMBRE,LOC

            HAVING COUNT(*) > 5   --A\D1ADIDOS HAVING

            ORDER BY EMPLEADOS;